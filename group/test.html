<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <style>
    div {
      background-color: red;
      border: 10px #000;
    }
  </style>
  <body>
    <script>
      /*
      给定两个整数，分别表示分数的分子 numerator 和分母 denominator，
      以字符串形式返回小数。

      如果小数部分为循环小数，则将循环的部分括在括号内。

      示例 1:

      ```
      输入: numerator = 1, denominator = 2
      输出: "0.5"
      ```

      示例 2:

      ```
      输入: numerator = 2, denominator = 1
      输出: "2"
      ```

      示例 3:

      ```
      输入: numerator = 2, denominator = 3
      输出: "0.(6)"
      ```
      */
      var fractionToDecimal = function(numerator, denominator) {
        if (denominator === 1) return numerator + '';
        if (numerator === 0) return '0';
        // 先将除数和被除数都转换为正数，保留最后的负号
        const flag = (numerator < 0 && denominator > 0) || (numerator > 0 && denominator < 0);
        numerator = Math.abs(numerator);
        denominator = Math.abs(denominator);
        // 小数点位数
        let digits = 0;
        // 余数集合
        // const numeraArray = [];
        const numeraMap = {};
        // 商集合
        let res = [];
        while (numerator !== 0) {
          const quotient = Math.floor(numerator / denominator);
          numerator %= denominator;
          res.push(quotient);
          const isIndex = numeraMap[ numerator ];
          // 若之前出现过该余数则为无限循环小数，提取其中循环字段即可
          if (isIndex >= 0) {
            const decimals = res.splice(0, isIndex + 1);
            digits -= res.length - 1;
            decimals.push(`(${res.join('')})`);
            res = decimals;
            break;
          }
          numeraMap[ numerator ] = digits;
          // 若余数小于除数，则小数部分退1位
          if (0 < numerator && numerator < denominator) {
            numerator *= 10;
            digits++;
          }
        }
        if (flag) {
          res.unshift('-');
        }
        // 补上小数点
        if (digits !== 0) {
          res.splice(res.length - digits, 0, '.');
        }
        return res.join('');
      };
      console.log(fractionToDecimal(8, 7));
    </script>
  </body>
</html>
